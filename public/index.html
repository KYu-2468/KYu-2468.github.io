<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <!--
      manifest.json provides metadata used when your web app is installed on a
      user's mobile device or desktop. See https://developers.google.com/web/fundamentals/web-app-manifest/
    -->
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <!--
      Notice the use of %PUBLIC_URL% in the tags above.
      It will be replaced with the URL of the `public` folder during the build.
      Only files inside the `public` folder can be referenced from the HTML.

      Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will
      work correctly both with client-side routing and a non-root public URL.
      Learn how to configure a non-root public URL by running `npm run build`.
    -->
    <title>Kevin Yu Portfolio</title>

    <!-- Ready Player Me styling start -->

    <style>
      html,
      body,
      .frame {
        width: 1080px;
        height: 800px;
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen,
          Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;
        padding: 20px;
        font-size: 14px;
        border: none;
      }

      .warning {
        background-color: #df68a2;
        padding: 3px;
        border-radius: 5px;
        color: white;
      }
    </style>

    <!-- Ready Player Me styling end -->
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    <!--
      This HTML file is a template.
      If you open it directly in the browser, you will see an empty page.

      You can add webfonts, meta tags, or analytics to this file.
      The build step will place the bundled scripts into the <body> tag.

      To begin the development, run `npm start` or `yarn start`.
      To create a production bundle, use `npm run build` or `yarn build`.
    -->
    <!-- Calendly inline widget begin -->
    <div
      class="calendly-inline-widget"
      data-url="https://calendly.com/kevin-yu-2468/20-min-chat"
      style="min-width: 320px; height: 660px"
    ></div>
    <script
      type="text/javascript"
      src="https://assets.calendly.com/assets/external/widget.js"
      async
    ></script>
    <!-- Calendly inline widget end -->

    <!-- Ready Player Me start -->

    <h2>Ready Player Me iframe example</h2>
    <ul>
      <li>Click the "Open Ready Player Me" button.</li>
      <li>
        Create an avatar and click the "Done" button when you're done
        customizing.
      </li>
      <li>After creation, this parent page receives the URL to the avatar.</li>
      <li>The Ready Player Me window closes and the URL is displayed.</li>
    </ul>
    <p class="warning">
      If you have a subdomain, replace the 'demo' subdomain in the iframe source
      URL with yours.
    </p>

    <input
      type="button"
      value="Open Ready Player Me"
      onClick="displayIframe()"
    />
    <p id="avatarUrl">Avatar URL:</p>

    <iframe
      id="frame"
      class="frame"
      allow="camera *; microphone *; clipboard-write"
      hidden
    ></iframe>

    <script>
      const subdomain = "demo"; // Replace with your custom subdomain
      const frame = document.getElementById("frame");

      frame.src = `https://${subdomain}.readyplayer.me/avatar?frameApi`;

      window.addEventListener("message", subscribe);
      document.addEventListener("message", subscribe);

      function subscribe(event) {
        const json = parse(event);

        if (json?.source !== "readyplayerme") {
          return;
        }

        // Susbribe to all events sent from Ready Player Me once frame is ready
        if (json.eventName === "v1.frame.ready") {
          frame.contentWindow.postMessage(
            JSON.stringify({
              target: "readyplayerme",
              type: "subscribe",
              eventName: "v1.**",
            }),
            "*"
          );
        }

        // Get avatar GLB URL
        if (json.eventName === "v1.avatar.exported") {
          console.log(`Avatar URL: ${json.data.url}`);
          document.getElementById(
            "avatarUrl"
          ).innerHTML = `Avatar URL: ${json.data.url}`;
          document.getElementById("frame").hidden = true;
        }

        // Get user id
        if (json.eventName === "v1.user.set") {
          console.log(
            `User with id ${json.data.id} set: ${JSON.stringify(json)}`
          );
        }
      }

      function parse(event) {
        try {
          return JSON.parse(event.data);
        } catch (error) {
          return null;
        }
      }

      function displayIframe() {
        document.getElementById("frame").hidden = false;
      }
    </script>

    <!-- Ready Player Me end -->
  </body>
</html>
